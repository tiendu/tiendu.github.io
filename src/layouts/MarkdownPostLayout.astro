---
// src/layouts/MarkdownPostLayout.astro
import BaseLayout from "./BaseLayout.astro";
const { frontmatter } = Astro.props;

const title = frontmatter.title ?? "Untitled Post";
const description = frontmatter.description ?? "";
const pubDate = frontmatter.pubDate ? new Date(frontmatter.pubDate) : null;
const tags = frontmatter.tags ?? [];

// friendly date: 26th October 2025
function formatDate(date) {
  const day = date.getDate();
  const suffix =
    ["th", "st", "nd", "rd"][day % 10 > 3 || Math.floor(day / 10) === 1 ? 0 : day % 10];
  const month = date.toLocaleString("en-GB", { month: "long" });
  const year = date.getFullYear();
  return `${day}${suffix} ${month} ${year}`;
}
const formattedDate = pubDate ? formatDate(pubDate) : "";
---
<BaseLayout title={title} description={description}>
  <article class="post">
    <header>
      <h1>{title}</h1>
      {description && <p class="desc"><em>{description}</em></p>}
      {formattedDate && <p class="date">{formattedDate}</p>}

      {tags.length > 0 && (
        <div class="tags">
          {tags.map((tag) => (
            <span class="tag">
              <a href={`${import.meta.env.BASE_URL}tags/${tag}/`}>#{tag}</a>
            </span>
          ))}
        </div>
      )}
    </header>

    <section class="content">
      <slot />
    </section>
  </article>
</BaseLayout>

<style>
  .post header { margin-bottom: 2rem; }
  h1 { font-size: 2.2rem; margin-bottom: 0.5rem; }
  .desc { margin: 0.25rem 0; color: #555; }
  .date { color: #666; font-size: 0.95rem; }
  a { color: #00539f; text-decoration: none; }
  .tags { display: flex; flex-wrap: wrap; margin: 1em 0; }
  .tag {
    margin: 0.25em;
    border: 1px dotted #a1a1a1;
    border-radius: .5em;
    padding: .4em .8em;
    font-size: 0.95em;
    background: #f8fcfd;
  }
</style>
