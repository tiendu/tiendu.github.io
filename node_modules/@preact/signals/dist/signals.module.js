import{Component as i,options as n,isValidElement as t,Fragment as r}from"preact";import{useMemo as o,useState as f,useRef as e,useEffect as u}from"preact/hooks";import{effect as a,Signal as c,computed as v,signal as s,batch as d}from"@preact/signals-core";export{Signal,batch,computed,effect,signal,untracked}from"@preact/signals-core";var h,p,w,l=[],m=[];a(function(){h=this.N})();function y(i,t){n[i]=t.bind(null,n[i]||function(){})}function _(i){if(w)w();w=i&&i.S()}function g(i){var n=this,r=i.data,f=useSignal(r);f.value=r;var e=o(function(){var i=n,r=n.__v;while(r=r.__)if(r.__c){r.__c.__$f|=4;break}var o=v(function(){var i=f.value.value;return 0===i?0:!0===i?"":i||""}),e=v(function(){return!Array.isArray(o.value)&&!t(o.value)}),u=a(function(){this.N=F;if(e.value){var n=o.value;if(i.__v&&i.__v.__e&&3===i.__v.__e.nodeType)i.__v.__e.data=n}}),c=n.__$u.d;n.__$u.d=function(){u();c.call(this)};return[e,o]},[]),u=e[0],c=e[1];return u.value?c.peek():c.value}g.displayName="ReactiveTextNode";Object.defineProperties(c.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:g},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});y("__b",function(i,n){if("function"==typeof n.type&&"undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();if("string"==typeof n.type){var t,r=n.props;for(var o in r)if("children"!==o){var f=r[o];if(f instanceof c){if(!t)n.__np=t={};t[o]=f;r[o]=f.peek()}}}i(n)});y("__r",function(i,n){if("function"==typeof n.type&&"undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(n);if(n.type!==r){_();var t,o=n.__c;if(o){o.__$f&=-2;if(void 0===(t=o.__$u))o.__$u=t=function(i){var n;a(function(){n=this});n.c=function(){o.__$f|=1;o.setState({})};return n}()}p=o;_(t)}i(n)});y("__e",function(i,n,t,r){if("undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();_();p=void 0;i(n,t,r)});y("diffed",function(i,n){if("function"==typeof n.type&&"undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();_();p=void 0;var t;if("string"==typeof n.type&&(t=n.__e)){var r=n.__np,o=n.props;if(r){var f=t.U;if(f)for(var e in f){var u=f[e];if(void 0!==u&&!(e in r)){u.d();f[e]=void 0}}else{f={};t.U=f}for(var a in r){var c=f[a],v=r[a];if(void 0===c){c=b(t,a,v,o);f[a]=c}else c.o(v,o)}}}i(n)});function b(i,n,t,r){var o=n in i&&void 0===i.ownerSVGElement,f=s(t);return{o:function(i,n){f.value=i;r=n},d:a(function(){this.N=F;var t=f.value.value;if(r[n]!==t){r[n]=t;if(o)i[n]=t;else if(t)i.setAttribute(n,t);else i.removeAttribute(n)}})}}y("unmount",function(i,n){if("string"==typeof n.type){var t=n.__e;if(t){var r=t.U;if(r){t.U=void 0;for(var o in r){var f=r[o];if(f)f.d()}}}}else{var e=n.__c;if(e){var u=e.__$u;if(u){e.__$u=void 0;u.d()}}}i(n)});y("__h",function(i,n,t,r){if(r<3||9===r)n.__$f|=2;i(n,t,r)});i.prototype.shouldComponentUpdate=function(i,n){var t=this.__$u,r=t&&void 0!==t.s;for(var o in n)return!0;if(this.__f||"boolean"==typeof this.u&&!0===this.u){var f=2&this.__$f;if(!(r||f||4&this.__$f))return!0;if(1&this.__$f)return!0}else{if(!(r||4&this.__$f))return!0;if(3&this.__$f)return!0}for(var e in i)if("__source"!==e&&i[e]!==this.props[e])return!0;for(var u in this.props)if(!(u in i))return!0;return!1};function useSignal(i,n){return f(function(){return s(i,n)})[0]}function useComputed(i,n){var t=o(function(){var t=s(i);return[t,v(function(){return t.value()},n)]},[]),r=t[0],f=t[1];p.__$f|=4;r.value=i;return f}var k="undefined"==typeof requestAnimationFrame?setTimeout:function(i){var n=function(){clearTimeout(t);cancelAnimationFrame(r);i()},t=setTimeout(n,35),r=requestAnimationFrame(n)},q=function(i){queueMicrotask(function(){queueMicrotask(i)})};function A(){d(function(){var i;while(i=l.shift())h.call(i)})}function T(){if(1===l.push(this))(n.requestAnimationFrame||k)(A)}function x(){d(function(){var i;while(i=m.shift())h.call(i)})}function F(){if(1===m.push(this))(n.requestAnimationFrame||q)(x)}function useSignalEffect(i,n){var t=e(i);t.current=i;u(function(){return a(function(){this.N=T;return t.current()},n)},[])}export{useComputed,useSignal,useSignalEffect};//# sourceMappingURL=signals.module.js.map
